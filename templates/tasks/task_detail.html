{% extends 'tasks/base.html' %}
{% load i18n %}

{% block title %}{% translate 'Tasks | Task Details' %}{% endblock %}

{% block content %}
  <section>
    <a href="{% url 'tasks:list_detail' task.list.id %}" class="d-flex gap-4 mb-4 text-decoration-none">
      <i class="bi bi-chevron-left"></i>
      {{ task.list.name|title }}
    </a>

    <div class="d-grid d-md-flex align-items-md-center justify-content-md-between gap-4 mb-4">
      <h1 class="mb-0">{{ task.title|title }}</h1>
      <div class="d-flex align-items-center gap-4">
        <a href="{% url 'tasks:update_task' task.id %}" class="btn btn-lg btn-dark shadow-sm d-flex align-items-center gap-4">
          <i class="bi bi-pencil"></i>
          {% translate 'Edit' %}
        </a>
        <button type="button" class="btn btn-lg btn-danger shadow-sm" data-bs-toggle="modal" data-bs-target="#deleteModal">
          <i class="bi bi-trash"></i>
          {% translate 'Delete' %}
        </button>
      </div>
    </div>

    <p class="lead">{{ task.description|default:'' }}</p>
    
    {% if task.completed %}
      <div class="alert alert-success rounded-4 shadow-sm d-grid gap-4 p-4">
        <h2 class="mb-0">
          {% translate 'Congrats' %}
        </h2>
        <p class="lead mb-0">
          {% translate 'Congrats on completing this task' %}
        </p>
      </div>
    {% endif %}

    <section class="card card-body border-0 p-4 rounded-4">
      <ul class="list-unstyled d-grid gap-4 mb-0">
        <li class="d-grid gap-1">
          <span>{% translate 'Completed' %}</span>
          <small class="text-muted">
            {% if task.completed %}
              {% translate 'Yes' %}
            {% else %}
              {% translate 'No' %}
            {% endif %}
          </small>
        </li>
        <li class="d-grid gap-1">
          <span>{% translate 'Priority' %}</span>
          <small class="text-muted">
            {% if task.starred %}
              {% translate 'High' %}
            {% else %}
              {% translate 'Low' %}
            {% endif %}
          </small>
        </li>
        <li class="d-grid gap-1">
          <span>{% translate 'Completion rate' %}</span>
          <small class="text-muted">{{ task.completion_rate }}</small>
        </li>
        <li class="d-grid gap-1">
          <span>{% translate 'Deadline' %}</span>
          <small class="text-muted">{{ task.deadline|default:'No deadline' }}</small>
        </li>
        <li class="d-grid gap-1">
          <span>{% translate 'Created' %}</span>
          <small class="text-muted">{{ task.created_at }}</small>
        </li>
        <li class="d-grid gap-1">
          <span>{% translate 'Last update' %}</span>
          <small class="text-muted">{{ task.updated_at }}</small>
        </li>
      </ul>
    </section>
  </section>

  <div class="modal fade modal-sheet" tabindex="-1" role="dialog" id="deleteModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content rounded-4 shadow p-4">
        <div class="modal-header border-bottom-0">
          <h1 class="modal-title dispaly-5">
            {% translate 'Delete Task' %}
          </h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body py-0 d-grid gap-4">
          <p class="lead mb-4">{% translate 'Are you sure you want to delete this task?' %}</p>
  
          <form id="form" action="{% url 'tasks:delete_task' task.id %}" method="post">
            {% csrf_token %}

            <button type="submit" class="btn btn-lg btn-danger shadow-sm">
              {% translate 'Delete' %}
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
{% endblock %}